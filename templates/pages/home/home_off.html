{% extends "../../main/main.html" %}
{% load static %}
{% block header %}
    <title>Home Page</title>
    <link rel="stylesheet" href="{% static "css/pages/home/home.css" %}">
{% endblock header %}
{% block content %}
    <div class="global">
        <div class="option">
            {% if active %}
                <a href="{% url "homepage" %}">Tout effacer</a>
            {% endif %}
        </div>
        <div class="offres">
            {% if annonces %}
            {% for annonce in annonces %}
                <div class="offre">
                    <div class="carousel-container">
                        <div class="carousel-track" id="carousel-{{ annonce.id }}">
                            {% for photo in annonce.photos.all %}
                            <div class="carousel-slide">
                                <a href="{% url 'annonce_page' annonce.id %}">
                                    <img src="{{ photo.image.url }}" alt="Photo de l'annonce {{ annonce.id }}">
                                </a>
                            </div>
                            {% endfor %}
                        </div>
                        
                        <button class="carousel-btn carousel-prev">❮</button>
                        <button class="carousel-btn carousel-next">❯</button>
                        
                        <div class="carousel-nav">
                            {% for photo in annonce.photos.all %}
                            <div class="carousel-dot" 
                                 data-carousel="carousel-{{ annonce.id }}" 
                                 data-index="{{ forloop.counter0 }}"></div>
                            {% endfor %}
                        </div>
                    </div>
                    
                    <a href="{% url 'annonce_page' annonce.id %}" style="text-decoration:none;color:black;">
                        <div class="info">
                            <p class="ville">{{annonce.house.city}}, Morroco</p>
                            <p class="adress">{{annonce.location_name}}</p>
                            <div class="price">
                                <p class="prix">{{annonce.rent}} MAD</p>
                                <p>par mois</p>
                            </div>
                        </div>
                    </a>
                </div>
            {% endfor %}
            {% endif %}
        </div>
    </div>
    <div class="box-filter">
        <div class="option-filtres">
            <div class="header">
                <div></div>
                <p>Filtres</p>
                <div class="close">
                    <i id="close" class="fa-solid fa-x"></i>
                </div>
            </div>
            <form action="{% url "filterannonce" %}" method="POST">
                {% csrf_token %}
                <div class="box">
                    <label for="type">Type de logement</label>
                    <select name="type" id="type">
                        <option value="Tous">Tous les types</option>
                        <option value="Appartement">Appartement</option>
                        <option value="Maison">Maison</option>
                        <option value="Studio">Studio</option>
                        <option value="Loft">Loft</option>
                        <option value="Chambre">Chambre</option>
                        <option value="Autre">Autre</option>
                    </select>
                </div>
                <div class="box">
                    <label for="city">Ville</label>
                    <select name="city">
                        <option value="">Sélectionnez une ville</option>
                        <option value="Agadir">Agadir</option>
                        <option value="Al Hoceïma">Al Hoceïma</option>
                        <option value="Beni Mellal">Beni Mellal</option>
                        <option value="Berkane">Berkane</option>
                        <option value="Casablanca">Casablanca</option>
                        <option value="Chefchaouen">Chefchaouen</option>
                        <option value="Dakhla">Dakhla</option>
                        <option value="El Jadida">El Jadida</option>
                        <option value="Errachidia">Errachidia</option>
                        <option value="Fès">Fès</option>
                        <option value="Guelmim">Guelmim</option>
                        <option value="Kenitra">Kenitra</option>
                        <option value="Khouribga">Khouribga</option>
                        <option value="Laâyoune">Laâyoune</option>
                        <option value="Marrakech">Marrakech</option>
                        <option value="Meknès">Meknès</option>
                        <option value="Mohammédia">Mohammédia</option>
                        <option value="Nador">Nador</option>
                        <option value="Ouarzazate">Ouarzazate</option>
                        <option value="Oujda">Oujda</option>
                        <option value="Rabat">Rabat</option>
                        <option value="Safi">Safi</option>
                        <option value="Salé">Salé</option>
                        <option value="Settat">Settat</option>
                        <option value="Tanger">Tanger</option>
                        <option value="Tétouan">Tétouan</option>
                        <option value="Tiznit">Tiznit</option>
                        <option value="Asilah">Asilah</option>
                        <option value="Azemmour">Azemmour</option>
                        <option value="Azrou">Azrou</option>
                        <option value="Ben Guerir">Ben Guerir</option>
                        <option value="Beni Ansar">Beni Ansar</option>
                        <option value="Bouarfa">Bouarfa</option>
                        <option value="Boulemane">Boulemane</option>
                        <option value="Chichaoua">Chichaoua</option>
                        <option value="Demnate">Demnate</option>
                        <option value="Essaouira">Essaouira</option>
                        <option value="Figuig">Figuig</option>
                        <option value="Fnideq">Fnideq</option>
                        <option value="Ifrane">Ifrane</option>
                        <option value="Imzouren">Imzouren</option>
                        <option value="Inezgane">Inezgane</option>
                        <option value="Jerada">Jerada</option>
                        <option value="Kalaat Mgouna">Kalaat Mgouna</option>
                        <option value="Khemisset">Khemisset</option>
                        <option value="Khenifra">Khenifra</option>
                        <option value="Larache">Larache</option>
                        <option value="Midelt">Midelt</option>
                        <option value="Missour">Missour</option>
                        <option value="Ouazzane">Ouazzane</option>
                        <option value="Saidia">Saidia</option>
                        <option value="Sefrou">Sefrou</option>
                        <option value="Sidi Ifni">Sidi Ifni</option>
                        <option value="Sidi Kacem">Sidi Kacem</option>
                        <option value="Sidi Slimane">Sidi Slimane</option>
                        <option value="Skhirat">Skhirat</option>
                        <option value="Tan-Tan">Tan-Tan</option>
                        <option value="Taourirt">Taourirt</option>
                        <option value="Taroudant">Taroudant</option>
                        <option value="Taza">Taza</option>
                        <option value="Temara">Temara</option>
                        <option value="Tinghir">Tinghir</option>
                        <option value="Youssoufia">Youssoufia</option>
                        <option value="Zagora">Zagora</option>
                    </select>
                </div>
                <div class="box">
                    <label for="loyer">Loyer</label>
                    <div class="prix">
                        <input type="number" name="prix-min" placeholder="Min">
                        <div>
                            -
                        </div>
                        <input type="number" name="prix-max" placeholder="Max">
                    </div>
                </div>
                <div class="box">
                    <label for="bedrooms">Nombre de chambre à coucher</label>
                    <input type="number" name="bedrooms" id="bedrooms" placeholder="Nombre de chambre">
                </div>
                <div class="box">
                    <label for="surface">Surface</label>
                    <div class="prix">
                        <input type="number" name="surface-min" placeholder="Min m²">
                        <div>
                            -
                        </div>
                        <input type="number" name="surface-max" placeholder="Max m²">
                    </div>
                </div>
                <div class="box">
                    <label for="furnished">Commodités</label>
                    <select name="furnished" id="furnished">
                        <option value="Tous">Meublé ou non meublé</option>
                        <option value="Meublé">Meublé</option>
                        <option value="Non meublé"></option>
                    </select>
                </div>
                <div class="box">
                    <label for="">Partager avec</label>
                    <select name="genre" id="genre">
                        <option value="Tous">Tous les genres</option>
                        <option value="Homme">Homme</option>
                        <option value="Femme">Femme</option>
                    </select>
                    <select name="status" id="status">
                        <option value="Tous">Toutes occupation</option>
                        <option value="Etudiant">Etudiant</option>
                        <option value="Employé">Employé</option>
                    </select>
                </div>
                <div class="box">
                    <label for="equipements">Equipements</label>
                    <div class="equips">
                        <div class="equip">
                            <input type="checkbox" name="garden"><p>Garden</p>
                        </div>
                        <div class="equip">
                            <input type="checkbox" name="parking"><p>Parking</p>
                        </div>
                        <div class="equip">
                            <input type="checkbox" name="balcony"><p>Balcony</p>
                        </div>
                        <div class="equip">
                            <input type="checkbox" name="ac"><p>AC</p>
                        </div>
                        <div class="equip">
                            <input type="checkbox" name="elevator"><p>Elevator</p>
                        </div>
                        <div class="equip">
                            <input type="checkbox" name="heating"><p>heating</p>
                        </div>
                    </div>
                </div>
                <div class="btn">
                    <button>Afficher le résultat</button>
                </div>
            </form>
        </div>
    </div>
    {% include "../../layouts/erreur.html" %}
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        document.querySelectorAll('.carousel-container').forEach(container => {
            const track = container.querySelector('.carousel-track');
            const prevBtn = container.querySelector('.carousel-prev');
            const nextBtn = container.querySelector('.carousel-next');
            const dots = container.querySelectorAll('.carousel-dot');
            
            nextBtn.addEventListener('click', () => {
                const scrollPos = track.scrollLeft + track.offsetWidth;
                const maxScroll = track.scrollWidth - track.offsetWidth;
                
                if (scrollPos >= maxScroll) {
                    track.scrollTo({ left: 0, behavior: 'smooth' });
                } else {
                    track.scrollBy({ left: track.offsetWidth, behavior: 'smooth' });
                }
            });
            
            // Prev button
            prevBtn.addEventListener('click', () => {
                const scrollPos = track.scrollLeft - track.offsetWidth;
                
                if (scrollPos <= 0) {
                    track.scrollTo({ left: track.scrollWidth, behavior: 'smooth' });
                } else {
                    track.scrollBy({ left: -track.offsetWidth, behavior: 'smooth' });
                }
            });
            
            dots.forEach(dot => {
                dot.addEventListener('click', function() {
                    const index = parseInt(this.getAttribute('data-index'));
                    track.scrollTo({
                        left: track.offsetWidth * index,
                        behavior: 'smooth'
                    });
                });
            });
            
            track.addEventListener('scroll', function() {
                const currentIndex = Math.round(this.scrollLeft / this.offsetWidth);
                dots.forEach((dot, index) => {
                    dot.classList.toggle('active', index === currentIndex);
                });
            });
        });
    });
    </script>
    <script src="{% static "js/home/home.js" %}"></script>
    <script src="https://kit.fontawesome.com/1153728611.js" crossorigin="anonymous"></script>
{% endblock content %}